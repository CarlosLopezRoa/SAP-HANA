SELECT PLAY_CLI, SUM(CLIENTES_VENTAS) FROM (
-----************
CREATE COLUMN TABLE "VENTAS_POR_PLAY_24" AS (
SELECT CASE WHEN (A.ORIG_ID=3 AND "REGION" = 'ND') THEN 'METROPOLITANA' 
		WHEN (A.ORIG_ID=3 AND "REGION" IS NULL) THEN 'METROPOLITANA' 
		WHEN (A.ORIG_ID in (1,2) AND "REGION" = 'ND') THEN 'INTERIOR' 
		WHEN (A.ORIG_ID in (1,2) AND "REGION" IS NULL) THEN 'INTERIOR' 
		WHEN (A.ORIG_ID in (4) AND "REGION" = 'ND') THEN 'NORESTE'
		WHEN (A.ORIG_ID in (4) AND "REGION" IS NULL) THEN 'NORESTE'  
		ELSE "REGION" END AS REGION , 
		PLAY_CLI, CALMONTH, CANAL, CLIENTES_VENTAS, CLIENTES_VENTAS_PM, 
		RGU_VENTAS, RGU_VENTAS_PM, NO_CTES_INI_MES, NO_CTES_INI_MES_PM, 
		NO_CTES_FIN_MES, NO_CTES_FIN_MES_PM
FROM(
	SELECT A.ORIG_ID, A.ID_REGION, A.PLAY_CLI, A.CALMONTH, A.CANAL, 
		A.CLIENTES_VENTAS, B.CLIENTES_VENTAS AS CLIENTES_VENTAS_PM, 
		A.RGU_VENTAS, B.RGU_VENTAS AS RGU_VENTAS_PM, 
		NULL AS NO_CTES_INI_MES, NULL AS NO_CTES_INI_MES_PM, 
		NULL AS NO_CTES_FIN_MES, NULL AS NO_CTES_FIN_MES_PM
	FROM(
		SELECT ORIG_ID, ID_REGION, PLAY_CLI, CANAL, CALMONTH, 
			COUNT(DISTINCT CLIENTE) AS CLIENTES_VENTAS, 
			SUM(RGU_VENTAS) AS RGU_VENTAS
		FROM(
			SELECT A.ORIG_ID, A.ID_REGION, 'ND' AS CANAL, 
				CASE WHEN LENGTH(C.PLAY)=1 
				THEN 'SIGLE' WHEN LENGTH(C.PLAY)>1 THEN 'MULTI' 
				ELSE 'ND' END AS PLAY_CLI, A.CLIENTE, B.CALMONTH, 
				SUM(COALESCE(VENTA_NUEVA,UPSALE)) AS RGU_VENTAS
			FROM T2.HANA_STG1_ORDERS A 
				INNER JOIN "_SYS_BIC"."T/ATT_TIME_HANA" B
				ON A.FECHA=B.DATE_SQL
				LEFT OUTER JOIN T1.HANA_STG1_MT_CLIENTES C
				ON A.ORIG_ID=C.ORIG_ID AND A.CLIENTE=C.CLIENTE
			WHERE B.CALMONTH BETWEEN '201507' AND '201507' 
				AND (VENTA_NUEVA IS NOT NULL OR UPSALE IS NOT NULL)
			GROUP BY A.ORIG_ID, A.ID_REGION,  
				CASE WHEN LENGTH(C.PLAY)=1 
				THEN 'SIGLE' WHEN LENGTH(C.PLAY)>1 THEN 'MULTI' 
				ELSE 'ND' END, A.CLIENTE, B.CALMONTH
			)
		GROUP BY ORIG_ID, ID_REGION, PLAY_CLI, CANAL, CALMONTH
		) A LEFT OUTER JOIN (
		SELECT ORIG_ID, ID_REGION, PLAY_CLI, CANAL, CALMONTH, 
			COUNT(DISTINCT CLIENTE) AS CLIENTES_VENTAS, 
			SUM(RGU_VENTAS) AS RGU_VENTAS
		FROM(
			SELECT A.ORIG_ID, A.ID_REGION, 'ND' AS CANAL, 
				CASE WHEN LENGTH(C.PLAY)=1 
				THEN 'SIGLE' WHEN LENGTH(C.PLAY)>1 THEN 'MULTI' 
				ELSE 'ND' END AS PLAY_CLI, A.CLIENTE, 
				B.CALMONTH, SUM(COALESCE(VENTA_NUEVA,UPSALE)) AS RGU_VENTAS
			FROM T2.HANA_STG1_ORDERS A 
				INNER JOIN "_SYS_BIC"."T/ATT_TIME_HANA" B
				ON A.MES_1=B.DATE_SQL
				LEFT OUTER JOIN T1.HANA_STG1_MT_CLIENTES C
				ON A.ORIG_ID=C.ORIG_ID AND A.CLIENTE=C.CLIENTE
			WHERE B.CALMONTH BETWEEN '201507' AND '201507' 
				AND (VENTA_NUEVA IS NOT NULL OR UPSALE IS NOT NULL)
			GROUP BY A.ORIG_ID, A.ID_REGION,  
				CASE WHEN LENGTH(C.PLAY)=1 
				THEN 'SIGLE' WHEN LENGTH(C.PLAY)>1 THEN 'MULTI' 
				ELSE 'ND' END, A.CLIENTE, B.CALMONTH
			)
		GROUP BY ORIG_ID, ID_REGION, PLAY_CLI, CANAL, CALMONTH
		) B
			ON A.ORIG_ID=B.ORIG_ID AND A.ID_REGION=B.ID_REGION 
			AND A.PLAY_CLI=B.PLAY_CLI AND A.CANAL=B.CANAL
	UNION ALL
	SELECT A.ORIG_ID, A.ID_REGION, A.PLAY_CLI, A.CALMONTH, 'ND' AS CANAL, 
	NULL, NULL, NULL, NULL,
	A.NO_CTES_INI_MES, B.NO_CTES_INI_MES AS NO_CTES_INI_MES_PM, 
	A.NO_CTES_FIN_MES, B.NO_CTES_FIN_MES AS NO_CTES_FIN_MES_PM
	FROM(
		SELECT ORIG_ID, ID_REGION, CASE WHEN LENGTH(A.PLAY_CLI)=1 
			THEN 'SIGLE' WHEN LENGTH(A.PLAY_CLI)>1 THEN 'MULTI' 
			ELSE 'ND' END AS PLAY_CLI, B.CALMONTH, 
			SUM(NO_CTES_INI_MES) AS NO_CTES_INI_MES, SUM(NO_CTES_FIN_MES) 
			AS NO_CTES_FIN_MES
		FROM "T2"."HANA_STG1_RGU" A 
			INNER JOIN "_SYS_BIC"."T/ATT_TIME_HANA" B
			ON A.FECHA=B.DATE_SQL
		WHERE B.CALMONTH BETWEEN '201507' AND '201507'
		GROUP BY ORIG_ID, ID_REGION, CASE WHEN LENGTH(A.PLAY_CLI)=1 
				THEN 'SIGLE' WHEN LENGTH(A.PLAY_CLI)>1 THEN 'MULTI' 
				ELSE 'ND' END, B.CALMONTH
		) A LEFT OUTER JOIN (
		SELECT ORIG_ID, ID_REGION, CASE WHEN LENGTH(A.PLAY_CLI)=1 
				THEN 'SIGLE' WHEN LENGTH(A.PLAY_CLI)>1 THEN 'MULTI' 
				ELSE 'ND' END AS PLAY_CLI, B.CALMONTH, 
			SUM(NO_CTES_INI_MES) AS NO_CTES_INI_MES, 
			SUM(NO_CTES_FIN_MES) AS NO_CTES_FIN_MES
		FROM "T2"."HANA_STG1_RGU" A 
			INNER JOIN "_SYS_BIC"."T/ATT_TIME_HANA" B
			ON A.MES_1=B.DATE_SQL
		WHERE B.CALMONTH BETWEEN '201507' AND '201507'
		GROUP BY ORIG_ID, ID_REGION, CASE WHEN LENGTH(A.PLAY_CLI)=1 
				THEN 'SIGLE' WHEN LENGTH(A.PLAY_CLI)>1 THEN 'MULTI' 
				ELSE 'ND' END, B.CALMONTH
		) B
		ON A.ORIG_ID=B.ORIG_ID AND A.ID_REGION=B.ID_REGION 
		AND A.PLAY_CLI=B.PLAY_CLI
	) A LEFT OUTER JOIN "T1"."HANA_STG1_DIM_REGION" B
		ON A.ORIG_ID=B.ORIG_ID AND A.ID_REGION=B.ID
WHERE UPPER(CIUDAD) != 'SALTILLO'
);
---******

) GROUP BY PLAY_CLI
ORDER BY PLAY_CLI